{% extends "base.html" %}
{% block content %}

<h1>ğŸ›  ì¸í”„ë¼ ì‹œíŠ¸ ì¡°íšŒ 
    <button type="button" style="float: right;" onclick="location.href='/main'">ğŸ  ë©”ì¸ìœ¼ë¡œ</button>
</h1>

<form method="get" action="/infra" class="search-form">

    <fieldset style="display:flex; flex-wrap: wrap; gap: 15px;">
        <legend>ğŸ“Œ ì‹œíŠ¸ ì„ íƒ</legend>
        {% for label in sheet_options %}
        <label>
            <input type="checkbox" name="selected_sheets" value="{{ label }}"
                   {% if label == "ì „ì›” ë¬´ì„ ê°€ë™ì " or label in selected_sheets %}checked{% endif %}
                   onclick="handleCheckboxClick(this)">
            {{ label }}
        </label>
        {% endfor %}
    </fieldset>

    <div class="search-form" style="margin-top: 20px; display: flex; gap: 10px;">
        <select name="filter_column">
            <option value="ì‚¬ë²ˆ" {% if filter_column == "ì‚¬ë²ˆ" %}selected{% endif %}>ì‚¬ë²ˆ</option> 
            <option value="ì§€ì‚¬" {% if filter_column == "ì§€ì‚¬" %}selected{% endif %}>ì§€ì‚¬</option>
            <option value="ì„¼í„°" {% if filter_column == "ì„¼í„°" %}selected{% endif %}>ì„¼í„°</option>
            <option value="ì ‘ì ì½”ë“œ" {% if filter_column == "ì ‘ì ì½”ë“œ" %}selected{% endif %}>ì ‘ì ì½”ë“œ</option>
        </select>
        <input type="text" name="filter_value" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" value="{{ filter_value or '' }}">
        <button type="submit">ğŸ” ê²€ìƒ‰</button>
    </div>

</form>

<hr>

{% if tables %}
    {% for label, html in tables.items() %}
        <h2 style="margin-top: 40px;">ğŸ“„ {{ label }}</h2>
        <div class="table-wrapper">
            <div class="table-container">
                {{ html | safe }}
            </div>
        </div>
    {% endfor %}
{% else %}
    <p style="margin-top: 30px;">âœ… ì‹œíŠ¸ë¥¼ ì„ íƒí•˜ê³  ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
{% endif %}

<script>
// âœ… ì²´í¬ë°•ìŠ¤ í´ë¦­ ì‹œ ë‹¤ë¥¸ ì²´í¬ë°•ìŠ¤ ìë™ í•´ì œ
function handleCheckboxClick(clicked) {
    document.querySelectorAll('input[name="selected_sheets"]').forEach(checkbox => {
        if (checkbox !== clicked) checkbox.checked = false;
    });
}
</script>

<style>
.meta-count {
    font-weight: normal;
    color: #666;
    margin-left: 10px;
}
.meta-separator {
    border-top: 1px solid #ccc;
    margin: 10px 0;
}
.reply-separator {
    border-top: 1px solid #ddd;
    margin: 14px 0;
}
.text {
    white-space: pre-wrap;
    font-size: 30px;
}
.reply-list .reply {
    padding-left: 1em;
    position: relative;
    font-weight: bold;
}
.top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
/* âœ… ì‚¬ë²ˆ/ì´ë¦„ ì»¬ëŸ¼ ìë™ ìˆ¨ê¹€ */
.table-container table th:nth-child(1),
.table-container table td:nth-child(1),
.table-container table th:nth-child(2),
.table-container table td:nth-child(2) {
    display: none;
}
</style>

{% endblock %}
